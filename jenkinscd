pipeline {
    agent any
    environment {
        registry = 'arinataka/cd_project'
        dockerImage = ''
        registryCredential = 'docker-id'

    }
    stages{ 
        
        stage('checkout'){ 
        steps {
               checkout([$class: 'GitSCM', branches: [[name: '*/master']], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[credentialsId: '726711f4-103b-487b-aee0-8cad15c56626', url: 'https://github.com/Moetez-abidi/testjenk']]])
        }
        }
        stage('Building image') {
        steps{
            script {
          dockerImage = docker.build registry
                }
            }
        }
        stage('Upload Image') {
        steps{    
         script {
            docker.withRegistry( '', registryCredential ) {
            dockerImage.push()
                }
                }
            }
        }
        
    } 
}